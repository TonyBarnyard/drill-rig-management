<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drill Rig Management System - Pilgangoora</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script>
    const { useState, useEffect } = React;

    function App() {
      const [currentPage, setCurrentPage] = useState('fleet');
      const [selectedRig, setSelectedRig] = useState('DR201');
      const [adminMode, setAdminMode] = useState(false);
      const [adminPassword, setAdminPassword] = useState('admin123');
      const [showLoginPrompt, setShowLoginPrompt] = useState(false);
      const [loginAttempt, setLoginAttempt] = useState('');

      // Drill String Management
      const [authorisedStrings, setAuthorisedStrings] = useState(() => {
        const saved = localStorage.getItem('authorisedStrings');
        return saved ? JSON.parse(saved) : {};
      });

      const [rigStringAssignments, setRigStringAssignments] = useState(() => {
        const saved = localStorage.getItem('rigStringAssignments');
        return saved ? JSON.parse(saved) : {};
      });

      const [showCreateString, setShowCreateString] = useState(false);
      const [newStringName, setNewStringName] = useState('');
      const [newStringComponents, setNewStringComponents] = useState([]);
      const [componentInput, setComponentInput] = useState('');

      // Available components for selection
      const availableComponents = [
        { name: 'SCS Assembly (Spindle)', color: 'bg-blue-600', height: '80px' },
        { name: 'Saver Sub', color: 'bg-blue-500', height: '60px' },
        { name: 'Shock Sub (Montrae 4600)', color: 'bg-purple-600', height: '90px' },
        { name: 'Shock Sub (Montrae 5600)', color: 'bg-purple-700', height: '100px' },
        { name: 'Shock Sub (Montrae 3600)', color: 'bg-purple-500', height: '85px' },
        { name: 'Drill Pipe (6m)', color: 'bg-green-600', height: '120px' },
        { name: 'Drill Collar (127mm)', color: 'bg-green-700', height: '120px' },
        { name: 'Hammer (RH460)', color: 'bg-red-600', height: '75px' },
        { name: 'Bit (QL80)', color: 'bg-red-700', height: '65px' },
        { name: 'Crossover (API-DIBH 102)', color: 'bg-yellow-600', height: '70px' },
      ];

      const fleet = {
        'DR201': { model: 'D65', location: 'Collar Zone', status: 'Active', hours: 2847 },
        'DR202': { model: 'D65', location: 'Overburden', status: 'Active', hours: 2934 },
        'DR203': { model: 'D65', location: 'Production', status: 'Active', hours: 3102 },
        'DR204': { model: 'D65', location: 'Production', status: 'Active', hours: 2756 },
        'DR205': { model: 'D65', location: 'Production', status: 'Standby', hours: 1829 },
        'DR206': { model: 'D65', location: 'Production', status: 'Active', hours: 2645 },
        'DR207': { model: 'D65', location: 'Wall Control', status: 'Active', hours: 2234 },
        'DR208': { model: 'D65', location: 'Production', status: 'Active', hours: 2987 },
        'DR209': { model: 'D65', location: 'Production', status: 'Active', hours: 3045 },
        'DR210': { model: 'D65', location: 'Deep Prod', status: 'Active', hours: 2123 },
        'DR211': { model: 'D65', location: 'Production', status: 'Active', hours: 2876 },
        'DR212': { model: 'D65', location: 'Production', status: 'Active', hours: 2645 },
        'DR213': { model: 'D65', location: 'Production', status: 'Active', hours: 2734 },
        'DR214': { model: 'D65', location: 'Wall Control', status: 'Maintenance', hours: 1456 },
      };

      // Save to localStorage
      useEffect(() => {
        localStorage.setItem('authorisedStrings', JSON.stringify(authorisedStrings));
      }, [authorisedStrings]);

      useEffect(() => {
        localStorage.setItem('rigStringAssignments', JSON.stringify(rigStringAssignments));
      }, [rigStringAssignments]);

      const handleAdminLogin = () => {
        if (loginAttempt === adminPassword) {
          setAdminMode(true);
          setShowLoginPrompt(false);
          setLoginAttempt('');
        } else {
          alert('âŒ Incorrect password');
          setLoginAttempt('');
        }
      };

      const handleLogout = () => {
        setAdminMode(false);
      };

      const createDrillString = () => {
        if (!newStringName.trim()) {
          alert('Please enter a string name');
          return;
        }
        if (newStringComponents.length === 0) {
          alert('Please add at least one component');
          return;
        }
        const stringId = Date.now().toString();
        setAuthorisedStrings({
          ...authorisedStrings,
          [stringId]: {
            id: stringId,
            name: newStringName,
            components: newStringComponents,
            created: new Date().toLocaleDateString()
          }
        });
        alert(`âœ“ Drill string "${newStringName}" created!`);
        setNewStringName('');
        setNewStringComponents([]);
        setShowCreateString(false);
      };

      const addComponentToString = (component) => {
        setNewStringComponents([...newStringComponents, component]);
        setComponentInput('');
      };

      const removeComponentFromString = (index) => {
        setNewStringComponents(newStringComponents.filter((_, i) => i !== index));
      };

      const assignStringToRig = (stringId) => {
        setRigStringAssignments({
          ...rigStringAssignments,
          [selectedRig]: stringId
        });
        alert(`âœ“ String assigned to ${selectedRig}`);
      };

      // ==================== LOGIN SCREEN ====================
      if (showLoginPrompt) {
        return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 flex items-center justify-center p-4' },
          React.createElement('div', { className: 'bg-gradient-to-br from-slate-800 to-slate-900 border border-red-500/30 rounded-lg p-8 max-w-sm w-full' },
            React.createElement('h2', { className: 'text-2xl font-bold text-red-400 mb-6 text-center' }, 'ðŸ”“ Admin Login'),
            React.createElement('input', {
              type: 'password',
              placeholder: 'Password',
              value: loginAttempt,
              onChange: (e) => setLoginAttempt(e.target.value),
              onKeyPress: (e) => e.key === 'Enter' && handleAdminLogin(),
              className: 'w-full bg-slate-600 text-white rounded px-4 py-2 mb-4'
            }),
            React.createElement('button', {
              onClick: handleAdminLogin,
              className: 'w-full bg-red-600 hover:bg-red-500 text-white py-2 rounded font-bold mb-2'
            }, 'Login'),
            React.createElement('button', {
              onClick: () => setShowLoginPrompt(false),
              className: 'w-full bg-gray-600 hover:bg-gray-500 text-white py-2 rounded font-bold'
            }, 'Cancel')
          )
        );
      }

      // ==================== ADMIN - CREATE STRING ====================
      if (adminMode && showCreateString) {
        return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-white' },
          React.createElement('nav', { className: 'bg-slate-900 border-b border-blue-500/30 p-4' },
            React.createElement('div', { className: 'max-w-7xl mx-auto flex justify-between' },
              React.createElement('h1', { className: 'text-2xl font-bold text-blue-400' }, 'â›“ï¸ Create Authorised Drill String'),
              React.createElement('button', {
                onClick: () => { setShowCreateString(false); setNewStringComponents([]); },
                className: 'bg-gray-600 text-white px-4 py-2 rounded'
              }, 'Back')
            )
          ),
          React.createElement('div', { className: 'max-w-7xl mx-auto p-6' },
            React.createElement('div', { className: 'grid grid-cols-1 lg:grid-cols-3 gap-6' },
              // Left - String Configuration
              React.createElement('div', { className: 'lg:col-span-2 space-y-4' },
                React.createElement('div', { className: 'bg-gradient-to-br from-slate-700 to-slate-800 border border-blue-500/30 rounded-lg p-6' },
                  React.createElement('h3', { className: 'text-xl font-bold text-blue-400 mb-4' }, 'ðŸ“ String Details'),
                  React.createElement('input', {
                    type: 'text',
                    placeholder: 'String name (e.g., "Production with Shock Sub")',
                    value: newStringName,
                    onChange: (e) => setNewStringName(e.target.value),
                    className: 'w-full bg-slate-600 text-white rounded px-4 py-2 mb-4'
                  }),
                  React.createElement('h4', { className: 'text-blue-300 font-bold mb-2' }, 'ðŸ§© Add Components'),
                  React.createElement('div', { className: 'flex gap-2 mb-4' },
                    React.createElement('select', {
                      value: componentInput,
                      onChange: (e) => setComponentInput(e.target.value),
                      className: 'flex-1 bg-slate-600 text-white rounded px-4 py-2'
                    },
                      React.createElement('option', { value: '' }, 'Select component...'),
                      availableComponents.map((comp, idx) =>
                        React.createElement('option', { key: idx, value: comp.name }, comp.name)
                      )
                    ),
                    React.createElement('button', {
                      onClick: () => componentInput && addComponentToString(componentInput),
                      className: 'bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded font-bold'
                    }, 'Add')
                  ),
                  React.createElement('div', { className: 'space-y-2' },
                    newStringComponents.length > 0 && React.createElement('h4', { className: 'text-green-400 font-bold' }, `${newStringComponents.length} components selected:`),
                    newStringComponents.map((comp, idx) =>
                      React.createElement('div', { key: idx, className: 'bg-slate-600/50 p-2 rounded flex justify-between' },
                        React.createElement('span', { className: 'text-gray-300' }, `${idx + 1}. ${comp}`),
                        React.createElement('button', {
                          onClick: () => removeComponentFromString(idx),
                          className: 'text-red-400 hover:text-red-300 font-bold'
                        }, 'âœ•')
                      )
                    )
                  )
                ),
                React.createElement('button', {
                  onClick: createDrillString,
                  className: 'w-full bg-green-600 hover:bg-green-500 text-white py-3 rounded font-bold text-lg'
                }, 'âœ“ Create Authorised String')
              ),
              // Right - Preview
              React.createElement('div', { className: 'lg:col-span-1' },
                React.createElement('div', { className: 'bg-gradient-to-br from-slate-700 to-slate-800 border border-blue-500/30 rounded-lg p-6 sticky top-6' },
                  React.createElement('h4', { className: 'text-blue-400 font-bold mb-4' }, 'ðŸ‘€ Preview'),
                  React.createElement('div', { className: 'flex flex-col items-center gap-1' },
                    newStringComponents.length === 0 && React.createElement('p', { className: 'text-gray-400 text-center' }, 'Add components to preview'),
                    newStringComponents.map((comp, idx) =>
                      React.createElement('div', {
                        key: idx,
                        className: 'w-20 rounded text-xs text-center py-2 bg-gray-600 text-white overflow-hidden text-ellipsis'
                      }, comp.split(' ')[0])
                    )
                  )
                )
              )
            )
          )
        );
      }

      // ==================== ADMIN PANEL ====================
      if (adminMode) {
        return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-white' },
          React.createElement('nav', { className: 'bg-slate-900 border-b border-blue-500/30 p-4' },
            React.createElement('div', { className: 'max-w-7xl mx-auto flex justify-between items-center' },
              React.createElement('h1', { className: 'text-2xl font-bold text-blue-400' }, 'âš™ï¸ Admin Panel'),
              React.createElement('button', {
                onClick: handleLogout,
                className: 'bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded font-bold'
              }, 'Logout')
            )
          ),
          React.createElement('div', { className: 'max-w-7xl mx-auto p-6 space-y-6' },
            // Create String Button
            React.createElement('button', {
              onClick: () => setShowCreateString(true),
              className: 'w-full bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white py-4 rounded-lg font-bold text-lg'
            }, 'âž• Create New Authorised Drill String'),

            // Existing Strings
            React.createElement('div', { className: 'bg-gradient-to-br from-slate-700 to-slate-800 border border-blue-500/30 rounded-lg p-6' },
              React.createElement('h3', { className: 'text-2xl font-bold text-blue-400 mb-4' }, 'ðŸ“‹ Authorised Drill Strings'),
              Object.values(authorisedStrings).length === 0 ?
                React.createElement('p', { className: 'text-gray-400' }, 'No authorised strings created yet. Create one to get started!')
                :
                React.createElement('div', { className: 'space-y-3' },
                  Object.values(authorisedStrings).map((string) =>
                    React.createElement('div', { key: string.id, className: 'bg-slate-600/50 p-4 rounded border border-slate-500' },
                      React.createElement('div', { className: 'font-bold text-blue-300 mb-2' }, `${string.name}`),
                      React.createElement('div', { className: 'text-sm text-gray-300 mb-2' }, `${string.components.length} components â€¢ Created: ${string.created}`),
                      React.createElement('div', { className: 'text-xs text-gray-400' }, 
                        string.components.slice(0, 3).join(', ') + (string.components.length > 3 ? '...' : '')
                      )
                    )
                  )
                )
            ),

            React.createElement('button', {
              onClick: () => { setAdminMode(false); setCurrentPage('fleet'); },
              className: 'w-full bg-blue-600 hover:bg-blue-500 text-white py-2 rounded font-bold'
            }, 'â† Back to Fleet')
          )
        );
      }

      // ==================== FLEET DASHBOARD ====================
      if (currentPage === 'fleet') {
        return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-white' },
          React.createElement('nav', { className: 'bg-slate-900 border-b border-blue-500/30 p-4 sticky top-0' },
            React.createElement('div', { className: 'max-w-7xl mx-auto flex justify-between items-center' },
              React.createElement('h1', { className: 'text-2xl font-bold text-blue-400' }, 'â›ï¸ Drill Rig Management'),
              React.createElement('button', {
                onClick: () => setShowLoginPrompt(true),
                className: 'bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded font-bold'
              }, 'ðŸ”“ Admin')
            )
          ),
          React.createElement('div', { className: 'max-w-7xl mx-auto p-6' },
            React.createElement('h2', { className: 'text-3xl font-bold text-blue-400 mb-6' }, 'ðŸ“Š Fleet Dashboard - Pilgangoora'),
            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4' },
              Object.entries(fleet).map(([rigId, rig]) =>
                React.createElement('div', {
                  key: rigId,
                  onClick: () => { setSelectedRig(rigId); setCurrentPage('detail'); },
                  className: 'bg-gradient-to-br from-slate-700 to-slate-800 border border-blue-500/30 rounded-lg p-4 cursor-pointer hover:border-blue-400 hover:shadow-lg transition'
                },
                  React.createElement('div', { className: 'font-bold text-blue-400 text-lg mb-2' }, rigId),
                  React.createElement('div', { className: 'space-y-1 text-sm text-gray-300' },
                    React.createElement('div', null, `Model: ${rig.model}`),
                    React.createElement('div', null, `Location: ${rig.location}`),
                    React.createElement('div', { className: rig.status === 'Active' ? 'text-green-400' : 'text-yellow-400' }, `Status: ${rig.status}`),
                    React.createElement('div', { className: 'text-blue-300 font-bold' }, `Hours: ${rig.hours.toLocaleString()}`)
                  ),
                  rigStringAssignments[rigId] && React.createElement('div', { className: 'mt-2 pt-2 border-t border-gray-600 text-xs text-green-400 font-bold' }, 
                    `âœ“ String assigned`
                  ),
                  React.createElement('div', { className: 'mt-3 text-xs text-gray-400' }, 'â†’ Click to view')
                )
              )
            )
          )
        );
      }

      // ==================== RIG DETAIL ====================
      if (currentPage === 'detail') {
        const rig = fleet[selectedRig];
        const assignedStringId = rigStringAssignments[selectedRig];
        const assignedString = assignedStringId && authorisedStrings[assignedStringId];

        return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-white' },
          React.createElement('nav', { className: 'bg-slate-900 border-b border-blue-500/30 p-4 sticky top-0' },
            React.createElement('div', { className: 'max-w-7xl mx-auto flex justify-between items-center' },
              React.createElement('h1', { className: 'text-2xl font-bold text-blue-400' }, 'â›ï¸ Drill Rig Management'),
              React.createElement('button', {
                onClick: () => setShowLoginPrompt(true),
                className: 'bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded font-bold'
              }, 'ðŸ”“ Admin')
            )
          ),
          React.createElement('div', { className: 'max-w-7xl mx-auto p-6' },
            React.createElement('button', {
              onClick: () => setCurrentPage('fleet'),
              className: 'bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded font-bold mb-6'
            }, 'â† Back to Fleet'),

            React.createElement('div', { className: 'grid grid-cols-1 lg:grid-cols-3 gap-6' },
              // Left - Rig Info
              React.createElement('div', { className: 'space-y-4' },
                React.createElement('div', { className: 'bg-gradient-to-br from-slate-700 to-slate-800 border border-blue-500/30 rounded-lg p-6' },
                  React.createElement('h2', { className: 'text-3xl font-bold text-blue-400 mb-4' }, selectedRig),
                  React.createElement('div', { className: 'space-y-3 text-gray-300' },
                    React.createElement('div', { className: 'text-lg' },
                      React.createElement('span', { className: 'text-gray-400 font-bold' }, 'Model: '),
                      rig.model
                    ),
                    React.createElement('div', { className: 'text-lg' },
                      React.createElement('span', { className: 'text-gray-400 font-bold' }, 'Location: '),
                      rig.location
                    ),
                    React.createElement('div', { className: 'text-lg font-bold', style: { color: rig.status === 'Active' ? '#4ade80' : '#eab308' } },
                      `Status: ${rig.status}`
                    ),
                    React.createElement('div', { className: 'text-lg text-green-400 font-bold' },
                      `Hours: ${rig.hours.toLocaleString()}`
                    )
                  )
                )
              ),

              // Center & Right - Drill String
              React.createElement('div', { className: 'lg:col-span-2' },
                React.createElement('div', { className: 'bg-gradient-to-br from-slate-700 to-slate-800 border border-blue-500/30 rounded-lg p-6' },
                  React.createElement('h3', { className: 'text-2xl font-bold text-blue-400 mb-6' }, 'â›“ï¸ Authorised Drill String'),

                  assignedString ?
                    React.createElement('div', null,
                      React.createElement('div', { className: 'mb-4 p-4 bg-green-900/20 border border-green-500/30 rounded' },
                        React.createElement('div', { className: 'text-green-400 font-bold mb-2' }, `âœ“ Current: ${assignedString.name}`),
                        React.createElement('div', { className: 'flex gap-2' },
                          React.createElement('button', {
                            onClick: () => {
                              setRigStringAssignments({...rigStringAssignments, [selectedRig]: undefined});
                              alert('String removed');
                            },
                            className: 'bg-red-600 hover:bg-red-500 text-white px-3 py-1 rounded text-sm'
                          }, 'Remove String')
                        )
                      ),
                      React.createElement('div', { className: 'bg-slate-600/30 rounded p-8 mb-4' },
                        React.createElement('div', { className: 'flex flex-col items-center gap-1 min-h-96' },
                          assignedString.components.map((comp, idx) =>
                            React.createElement('div', {
                              key: idx,
                              className: 'w-24 rounded text-xs text-center py-3 bg-gradient-to-b from-blue-600 to-blue-700 text-white font-bold shadow-lg hover:shadow-xl transition'
                            }, comp.split(' ')[0] + ' ' + (comp.split(' ')[1] || ''))
                          )
                        )
                      )
                    )
                    :
                    React.createElement('div', null,
                      React.createElement('p', { className: 'text-gray-400 mb-4' }, 'No drill string assigned. Select one below:'),
                      React.createElement('div', { className: 'space-y-2' },
                        Object.values(authorisedStrings).length === 0 ?
                          React.createElement('p', { className: 'text-gray-500 text-sm' }, 'No authorised strings available. Create one in Admin Mode.')
                          :
                          Object.values(authorisedStrings).map((string) =>
                            React.createElement('button', {
                              key: string.id,
                              onClick: () => assignStringToRig(string.id),
                              className: 'w-full text-left bg-slate-600 hover:bg-blue-600 p-3 rounded transition'
                            },
                              React.createElement('div', { className: 'font-bold text-blue-300' }, string.name),
                              React.createElement('div', { className: 'text-xs text-gray-400' }, `${string.components.length} components`)
                            )
                          )
                      )
                    )
                )
              )
            )
          )
        );
      }

      return React.createElement('div', { className: 'min-h-screen bg-slate-900 flex items-center justify-center' },
        React.createElement('p', { className: 'text-white' }, 'Loading...')
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>
